import{C as U,r as T,D as v,d as M,s as C,e as j,o as i,c as d,a as t,t as b,k as $,v as P,n as S,h as f,E as F,q as z,b as E,j as w,F as L,i as N,u as k,l as D}from"./app.93c92701.js";import{s as A}from"./helpers.ec2122b1.js";const Et=U("sumSale",()=>{const s=T({cash:null,electron:null,debt:null});function r(){axios.post("/sale/dayinfo",{from:v().format(v.HTML5_FMT.DATE),to:v().add(1,"days").format(v.HTML5_FMT.DATE)}).then(({data:y})=>{s.value=A(y)})}return{Summa:s,getDayInfo:r}}),B={class:"border-y py-3 pl-3 text-left"},H={class:"border-y py-3"},q={class:"border-y py-3 w-32"},I=["placeholder"],Q={class:"border-y py-3"},R={class:"flex items-center justify-center"},W=["disabled"],G=t("i",{class:"fal fa-angle-left relative top-px"},null,-1),J=[G],K={class:"mx-4"},O=["disabled"],X=t("i",{class:"fal fa-angle-right relative top-px"},null,-1),Y=[X],Z={class:"border-y py-3"},tt={class:"border-y py-3"},et=t("i",{class:"fal fa-times"},null,-1),st=[et],Lt=M({__name:"TrProduct",props:["product","refund"],setup(s){const{product:r,refund:y}=s,u=T(r.selled_price),x=a=>a.totalCount--,g=a=>a.totalCount++;return C(()=>r,a=>{a.totalCount>a.count&&(a.totalCount=a.count),a.totalCount<0&&(a.totalCount=0),a.totalCount=Math.round(a.totalCount*1e3)/1e3},{deep:!0}),j(()=>{r.totalCount>r.count&&(r.totalCount=r.count)}),(a,c)=>(i(),d("tr",null,[t("td",B,b(s.product.product_names.name),1),t("td",H,b(s.product.size.name),1),t("td",q,[$(t("input",{type:"number",class:"text-input border py-0 text-center","onUpdate:modelValue":c[0]||(c[0]=h=>s.product.selled_price=h),placeholder:u.value},null,8,I),[[P,s.product.selled_price]])]),t("td",Q,[t("div",R,[t("button",{disabled:s.product.totalCount==0,class:S([{"text-gray-300 hover:bg-inherit":s.product.totalCount==0},"px-3 py-0.5 hover:bg-gray-100 active:bg-gray-200 rounded-sm w-10"]),onClick:c[1]||(c[1]=h=>x(s.product))},J,10,W),t("span",K,[$(t("input",{type:"number",class:"text-input border py-0 text-center w-24","onUpdate:modelValue":c[2]||(c[2]=h=>s.product.totalCount=h)},null,512),[[P,s.product.totalCount]])]),t("button",{disabled:s.product.totalCount==s.product.count,class:S([{"text-gray-300 hover:bg-inherit":s.product.totalCount==s.product.count},"px-3 py-0.5 hover:bg-gray-100 active:bg-gray-200 rounded-sm w-10"]),onClick:c[3]||(c[3]=h=>g(s.product))},Y,10,O)])]),t("td",Z,b(s.product.count),1),t("td",tt,b(Math.round(s.product.selled_price*s.product.totalCount*1e3)/1e3),1),s.refund?f("",!0):(i(),d("td",{key:0,onClick:c[4]||(c[4]=h=>a.$emit("delete")),class:"border-y py-3 px-3 text-red-600 cursor-pointer hover:bg-gray-100 active:bg-slate-200"},st))]))}}),ot={class:"bg-gray-500 bg-opacity-20 w-full h-full absolute z-50 left-0 top-0 flex-center"},nt={key:0,class:"text-right bg-pink-600 border-b mb-0"},at=t("i",{class:"far fa-times text-white"},null,-1),lt=[at],it={key:1,class:"text-right bg-gray-100 border-b mb-0"},dt=t("i",{class:"far fa-times text-red-500"},null,-1),ct=[dt],rt=["onSubmit"],ut={class:"mb-1.5"},ht={class:"text-gray-400 flex-between-center"},mt={key:0},pt={key:1},bt={key:2},ft=["onClick"],yt=t("i",{class:"fa-solid fa-magnet"},null,-1),xt=[yt],gt=["onClick"],_t=["onClick"],vt=["onUpdate:modelValue"],kt={class:"flex items-center justify-end mt-3"},Ct=t("span",{class:"text-gray-500"}," Umumiy summa: ",-1),wt={class:"text-xl font-semibold text-gray-600 ml-5"},$t={key:0,class:"flex items-center justify-end mt-3 text-pink-500"},Pt=t("span",null," Umumiy summadan ortib ketti: ",-1),St={class:"ml-5"},Tt=["disabled"],Mt={key:0},Dt=t("span",{class:"px-4 text-gray-500"},[D(" Tahrirlash "),t("i",{class:"fa-duotone fa-pen-nib text-pink-500 relative top-px ml-3"})],-1),Vt=[Dt],Ut={key:1},jt=t("i",{class:"fa-light fa-check ml-3 text-pink-500"},null,-1),Nt=M({__name:"FinishedSold",props:["listProducts","totalPrice","sale"],emits:["sold","close","backup"],setup(s,{emit:r}){const{listProducts:y,totalPrice:u,sale:x}=s,g=F();function a(o){for(const e in n)e==o?n[e]=u:n[e]=null}function c(o){n[o]=null}function h(o){const e=[];for(const l in n)if(o!=l){const p=["",null].includes(n[l])?0:n[l];e.push(p)}const m=u-e.reduce((l,p)=>l+p,0);n[o]=m==0?null:m}const n=z({cash:u,electron:null,debt:null});C(()=>n.cash,(o,e)=>{(o>u||o<0)&&(n.cash=e)}),C(()=>n.debt,(o,e)=>{(o>u||o<0)&&(n.debt=e)}),C(()=>n.electron,(o,e)=>{(o>u||o<0)&&(n.electron=e)});function V(){const o=y.filter(e=>e.totalCount!=0);x?axios.patch(`sale/${x.id}`,{...n,listProducts:o,shop_id:g.user.active_shop}).then(({data:e})=>{r("backup",e)}):axios.post("sale",{...n,listProducts:o,shop_id:g.user.active_shop}).then(({data:e})=>{r("sold",e)})}const _=E(()=>{const o=[];for(const e in n)o.push(n[e]);return u-o.reduce((e,m)=>{const l=["",null].includes(m)?0:m;return e+l},0)});return(o,e)=>(i(),d("section",ot,[t("main",{onClick:e[3]||(e[3]=w(()=>{},["stop"])),class:"w-96 h-[500px] bg-white shadow-lg flex flex-col"},[s.sale?(i(),d("header",nt,[t("button",{onClick:e[0]||(e[0]=m=>o.$emit("close")),class:"px-4 py-2 hover:bg-pink-500"},lt)])):(i(),d("header",it,[t("button",{onClick:e[1]||(e[1]=m=>o.$emit("close")),class:"px-4 py-2 hover:bg-gray-200"},ct)])),t("form",{onSubmit:w(V,["prevent"]),class:"p-3 pt-2 flex flex-col justify-between h-full"},[t("main",null,[(i(!0),d(L,null,N(n,(m,l)=>(i(),d("div",ut,[t("aside",ht,[l=="cash"?(i(),d("span",mt,"Naxt")):f("",!0),l=="electron"?(i(),d("span",pt,"Plastik")):f("",!0),l=="debt"?(i(),d("span",bt,"Qarz")):f("",!0),t("main",null,[t("button",{onClick:p=>h(l),type:"button",class:"text-xs bg-gray-200 text-gray-500 w-10 py-0.5 rounded-sm shadow-sm mr-3 active:bg-pink-400 active:text-white hover:bg-pink-500 hover:text-white"},xt,8,ft),t("button",{onClick:p=>c(l),type:"button",class:"text-xs bg-gray-200 text-gray-500 w-10 py-0.5 rounded-sm shadow-sm mr-3 active:bg-pink-400 active:text-white hover:bg-pink-500 hover:text-white"}," 0% ",8,gt),t("button",{onClick:p=>a(l),type:"button",class:"text-xs bg-gray-200 text-gray-500 w-10 py-0.5 rounded-sm shadow-sm active:bg-pink-400 active:text-white hover:bg-pink-500 hover:text-white"}," 100% ",8,_t)])]),$(t("input",{onWheel:e[2]||(e[2]=w(()=>{},["prevent"])),type:"number","onUpdate:modelValue":p=>n[l]=p,step:"0.001",class:"text-input text-gray-600"},null,40,vt),[[P,n[l]]])]))),256)),t("aside",kt,[Ct,t("span",wt,b(s.totalPrice),1)]),k(_)<0?(i(),d("aside",$t,[Pt,t("span",St,b(k(_)),1)])):f("",!0)]),t("main",null,[t("button",{disabled:k(_)<0,class:S([{"!border-gray-200 text-gray-300 cursor-not-allowed":k(_)<0},"py-1 px-3 bg-gray-200 shadow-md active:shadow-sm border-b-2 border-pink-500 hover:bg-pink-100 active:bg-pink-50 w-full"])},[s.sale?(i(),d("span",Mt,Vt)):(i(),d("span",Ut,[D(" To'lovni amalga oshirish "),jt]))],10,Tt)])],40,rt)])]))}});export{Nt as _,Lt as a,Et as s};
