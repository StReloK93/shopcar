import{d as V,r as U,s as v,o as j,b as i,e as d,f as t,t as b,l as C,v as w,n as $,i as f,C as T,q as z,a as N,k,F as B,j as D,u as _,m as M}from"./app.0e1eeed2.js";const F={class:"border-y py-3 pl-3 text-left"},L={class:"border-y py-3"},q={class:"border-y py-3 w-32"},A=["placeholder"],E={class:"border-y py-3"},Q={class:"flex items-center justify-center"},R=["disabled"],W=t("i",{class:"fal fa-angle-left relative top-px"},null,-1),G=[W],H={class:"mx-4"},I=["disabled"],J=t("i",{class:"fal fa-angle-right relative top-px"},null,-1),K=[J],O={class:"border-y py-3"},X={class:"border-y py-3"},Y=t("i",{class:"fal fa-times"},null,-1),Z=[Y],Tt=V({__name:"TrProduct",props:["product","refund"],setup(s){const{product:r,refund:P}=s,u=U(r.selled_price),y=l=>l.totalCount--,x=l=>l.totalCount++;return v(()=>r,l=>{l.totalCount>l.count&&(l.totalCount=l.count),l.totalCount<0&&(l.totalCount=0),l.totalCount=Math.round(l.totalCount*1e3)/1e3},{deep:!0}),j(()=>{r.totalCount>r.count&&(r.totalCount=r.count)}),(l,c)=>(i(),d("tr",null,[t("td",F,b(s.product.product_names.name),1),t("td",L,b(s.product.size.name),1),t("td",q,[C(t("input",{type:"number",class:"text-input border py-0 text-center","onUpdate:modelValue":c[0]||(c[0]=h=>s.product.selled_price=h),placeholder:u.value},null,8,A),[[w,s.product.selled_price]])]),t("td",E,[t("div",Q,[t("button",{disabled:s.product.totalCount==0,class:$([{"text-gray-300 hover:bg-inherit":s.product.totalCount==0},"px-3 py-0.5 hover:bg-gray-100 active:bg-gray-200 rounded-sm w-10"]),onClick:c[1]||(c[1]=h=>y(s.product))},G,10,R),t("span",H,[C(t("input",{type:"number",class:"text-input border py-0 text-center w-24","onUpdate:modelValue":c[2]||(c[2]=h=>s.product.totalCount=h)},null,512),[[w,s.product.totalCount]])]),t("button",{disabled:s.product.totalCount==s.product.count,class:$([{"text-gray-300 hover:bg-inherit":s.product.totalCount==s.product.count},"px-3 py-0.5 hover:bg-gray-100 active:bg-gray-200 rounded-sm w-10"]),onClick:c[3]||(c[3]=h=>x(s.product))},K,10,I)])]),t("td",O,b(s.product.count),1),t("td",X,b(Math.round(s.product.selled_price*s.product.totalCount*1e3)/1e3),1),s.refund?f("",!0):(i(),d("td",{key:0,onClick:c[4]||(c[4]=h=>l.$emit("delete")),class:"border-y py-3 px-3 text-red-600 cursor-pointer hover:bg-gray-100 active:bg-slate-200"},Z))]))}}),tt={class:"bg-gray-500 bg-opacity-20 w-full h-full absolute z-50 left-0 top-0 flex-center"},et={key:0,class:"text-right bg-pink-600 border-b mb-0"},st=t("i",{class:"far fa-times text-white"},null,-1),ot=[st],nt={key:1,class:"text-right bg-gray-100 border-b mb-0"},lt=t("i",{class:"far fa-times text-red-500"},null,-1),at=[lt],it=["onSubmit"],dt={class:"mb-1.5"},ct={class:"text-gray-400 flex-between-center"},rt={key:0},ut={key:1},ht={key:2},pt=["onClick"],mt=t("i",{class:"fa-solid fa-magnet"},null,-1),bt=[mt],ft=["onClick"],yt=["onClick"],xt=["onUpdate:modelValue"],gt={class:"flex items-center justify-end mt-3"},_t=t("span",{class:"text-gray-500"}," Umumiy summa: ",-1),vt={class:"text-xl font-semibold text-gray-600 ml-5"},kt={key:0,class:"flex items-center justify-end mt-3 text-pink-500"},Ct=t("span",null," Umumiy summadan ortib ketti: ",-1),wt={class:"ml-5"},$t=["disabled"],Pt={key:0},Vt=t("span",{class:"px-4 text-gray-500"},[M(" Tahrirlash "),t("i",{class:"fa-duotone fa-pen-nib text-pink-500 relative top-px ml-3"})],-1),Mt=[Vt],St={key:1},Ut=t("i",{class:"fa-light fa-check ml-3 text-pink-500"},null,-1),zt=V({__name:"FinishedSold",props:["listProducts","totalPrice","sale"],emits:["sold","close","backup"],setup(s,{emit:r}){const{listProducts:P,totalPrice:u,sale:y}=s,x=T();function l(o){for(const e in n)e==o?n[e]=u:n[e]=null}function c(o){n[o]=null}function h(o){const e=[];for(const a in n)if(o!=a){const m=["",null].includes(n[a])?0:n[a];e.push(m)}const p=u-e.reduce((a,m)=>a+m,0);n[o]=p==0?null:p}const n=z({cash:u,electron:null,debt:null});v(()=>n.cash,(o,e)=>{(o>u||o<0)&&(n.cash=e)}),v(()=>n.debt,(o,e)=>{(o>u||o<0)&&(n.debt=e)}),v(()=>n.electron,(o,e)=>{(o>u||o<0)&&(n.electron=e)});function S(){const o=P.filter(e=>e.totalCount!=0);y?axios.patch(`sale/${y.id}`,{...n,listProducts:o,shop_id:x.user.active_shop}).then(({data:e})=>{r("backup",e)}):axios.post("sale",{...n,listProducts:o,shop_id:x.user.active_shop}).then(({data:e})=>{r("sold",e)})}const g=N(()=>{const o=[];for(const e in n)o.push(n[e]);return u-o.reduce((e,p)=>{const a=["",null].includes(p)?0:p;return e+a},0)});return(o,e)=>(i(),d("section",tt,[t("main",{onClick:e[3]||(e[3]=k(()=>{},["stop"])),class:"w-96 h-[500px] bg-white shadow-lg flex flex-col"},[s.sale?(i(),d("header",et,[t("button",{onClick:e[0]||(e[0]=p=>o.$emit("close")),class:"px-4 py-2 hover:bg-pink-500"},ot)])):(i(),d("header",nt,[t("button",{onClick:e[1]||(e[1]=p=>o.$emit("close")),class:"px-4 py-2 hover:bg-gray-200"},at)])),t("form",{onSubmit:k(S,["prevent"]),class:"p-3 pt-2 flex flex-col justify-between h-full"},[t("main",null,[(i(!0),d(B,null,D(n,(p,a)=>(i(),d("div",dt,[t("aside",ct,[a=="cash"?(i(),d("span",rt,"Naxt")):f("",!0),a=="electron"?(i(),d("span",ut,"Plastik")):f("",!0),a=="debt"?(i(),d("span",ht,"Qarz")):f("",!0),t("main",null,[t("button",{onClick:m=>h(a),type:"button",class:"text-xs bg-gray-200 text-gray-500 w-10 py-0.5 rounded-sm shadow-sm mr-3 active:bg-pink-400 active:text-white hover:bg-pink-500 hover:text-white"},bt,8,pt),t("button",{onClick:m=>c(a),type:"button",class:"text-xs bg-gray-200 text-gray-500 w-10 py-0.5 rounded-sm shadow-sm mr-3 active:bg-pink-400 active:text-white hover:bg-pink-500 hover:text-white"}," 0% ",8,ft),t("button",{onClick:m=>l(a),type:"button",class:"text-xs bg-gray-200 text-gray-500 w-10 py-0.5 rounded-sm shadow-sm active:bg-pink-400 active:text-white hover:bg-pink-500 hover:text-white"}," 100% ",8,yt)])]),C(t("input",{onWheel:e[2]||(e[2]=k(()=>{},["prevent"])),type:"number","onUpdate:modelValue":m=>n[a]=m,step:"0.001",class:"text-input text-gray-600"},null,40,xt),[[w,n[a]]])]))),256)),t("aside",gt,[_t,t("span",vt,b(s.totalPrice),1)]),_(g)<0?(i(),d("aside",kt,[Ct,t("span",wt,b(_(g)),1)])):f("",!0)]),t("main",null,[t("button",{disabled:_(g)<0,class:$([{"!border-gray-200 text-gray-300 cursor-not-allowed":_(g)<0},"py-1 px-3 bg-gray-200 shadow-md active:shadow-sm border-b-2 border-pink-500 hover:bg-pink-100 active:bg-pink-50 w-full"])},[s.sale?(i(),d("span",Pt,Mt)):(i(),d("span",St,[M(" To'lovni amalga oshirish "),Ut]))],10,$t)])],40,it)])]))}});export{zt as _,Tt as a};
