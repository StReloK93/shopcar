import{d as D,r as _,c as z,o as $,a as m,b as y,e as a,f as g,w as C,g as T,u,h as L,T as U,F as B,i as I,t as b,j as S,k as F,v as N,n as E,l as k,m as M,p as O,q as V,s as A,x as R,y as Q,z as K,A as X}from"./app.eed0d982.js";import{_ as q,a as G,s as H}from"./FinishedSold.vue_vue_type_script_setup_true_lang.57c98ec9.js";import"./useGridProductStore.df2f0e79.js";import"./helpers.ec2122b1.js";const J={class:"text-right bg-gray-100 border-b mb-0"},W=a("i",{class:"fa-light fa-minus relative top-px"},null,-1),Y=[W],Z=a("i",{class:"far fa-times text-red-500"},null,-1),ee=[Z],te={class:"flex-grow overflow-hidden overflow-y-auto list-products shadow-inner px-3"},ne={class:"w-full text-center mt-1"},se=a("tr",null,[a("td",{class:"py-2 font-semibold"},"Nomi"),a("td",{class:"py-2 font-semibold"},"Hajmi"),a("td",{class:"py-2 font-semibold"},"Narxi"),a("td",{class:"py-2 font-semibold"},"Soni"),a("td",{class:"py-2 font-semibold"},"Do'kondagi soni"),a("td",{class:"py-2 font-semibold"},"Umumiy narxi"),a("td",{class:"py-2 font-semibold"})],-1),ae=a("td",{class:"py-4 sticky bottom-0 bg-white",colspan:"4"},null,-1),oe=a("td",{class:"py-3 sticky bottom-0 bg-white font-semibold text-[18px]"},"Umumiy summa",-1),ie={class:"py-4 sticky bottom-0 bg-white font-semibold text-[18px]"},re=a("td",{class:"py-4 sticky bottom-0 bg-white"},null,-1),le={class:"bg-white p-3 border-t text-right flex justify-between items-center"},ce=["disabled"],ue={key:0},de={key:1},fe=a("i",{class:"fa-light fa-arrow-right-long relative top-px ml-3 text-pink-500"},null,-1),he=D({__name:"SoldListProducts",props:["listProducts"],emits:["close","sold","onrollup","onFinished"],setup(p,{emit:i}){const{listProducts:r}=p,e=M("getProductById",null),t=_(),n=_(!1);function s(){e(t.value),t.value=null}const o=z(()=>{const d=r.reduce((l,h)=>l+h.selled_price*h.totalCount,0);return Math.trunc(d*1e3)/1e3});function c(){n.value=!0,i("onFinished",n.value)}function f(){n.value=!1,i("onFinished",n.value)}const v=d=>{r.splice(d,1),r.length==0&&i("close")};return $(()=>{const d=document.getElementById("ListProducts");d.focus(),d.onkeyup=l=>{l.which==13&&l.ctrlKey?c():l.which==27&&i("close")}}),(d,l)=>(m(),y("section",{onClick:l[6]||(l[6]=h=>i("onrollup")),tabindex:"0",id:"ListProducts",class:"full-absolute flex-center p-4 pb-16 outline-none z-[100]"},[a("main",{onClick:l[5]||(l[5]=S(()=>{},["stop"])),class:"min-w-[630px] w-[900px] bg-white h-full flex flex-col justify-between relative"},[g(U,{name:"scale"},{default:C(()=>[n.value?(m(),T(q,{key:0,onClose:f,listProducts:p.listProducts,totalPrice:u(o),onSold:l[0]||(l[0]=h=>i("close"))},null,8,["listProducts","totalPrice"])):L("",!0)]),_:1}),a("header",J,[a("button",{onClick:l[1]||(l[1]=h=>i("onrollup")),class:"px-4 py-2 hover:bg-gray-200"},Y),a("button",{onClick:l[2]||(l[2]=h=>i("close")),class:"px-4 py-2 hover:bg-gray-200"},ee)]),a("main",te,[a("table",ne,[se,(m(!0),y(B,null,I(p.listProducts,(h,x)=>(m(),T(G,{product:h,key:x,onDelete:P=>v(x)},null,8,["product","onDelete"]))),128)),a("tr",null,[ae,oe,a("td",ie,b(u(o)),1),re])])]),a("footer",le,[a("form",{onSubmit:l[4]||(l[4]=S(h=>s(),["prevent"]))},[F(a("input",{type:"text",class:"text-input bg-inherit border","onUpdate:modelValue":l[3]||(l[3]=h=>t.value=h),placeholder:"Sotish ID-NNN"},null,512),[[N,t.value]])],32),a("button",{disabled:u(o)==0,onClick:c,class:E([{"!border-gray-300 text-gray-400 cursor-disabled bg-gray-300":u(o)==0},"py-1 px-3 bg-gray-200 shadow border-b-2 border-pink-500 hover:bg-pink-100 active:bg-pink-50"])},[u(o)==0?(m(),y("span",ue," Mahsulot kiriting ")):(m(),y("span",de,[k(" Davom ettirish "),fe]))],10,ce)])])]))}}),pe={class:"mb-2 flex text-gray-700 justify-end"},ve={class:"bg-gray-50 px-2 py-1.5 shadow-sm w-32 border-b border-pink-500"},me=a("p",{class:"text-sm text-gray-400 leading-none mb-2 flex justify-between"},[a("span",null," Umumiy "),a("i",{class:"fa-light fa-sigma text-pink-600"})],-1),ye={class:"leading-none font-semibold"},ge=a("div",{class:"h-full border-l mx-8"},null,-1),_e={class:"bg-gray-50 px-2 py-1.5 shadow-sm rounded w-32"},be=a("p",{class:"text-sm text-gray-400 leading-none mb-2 flex justify-between"},[a("span",null," Naxt "),a("i",{class:"fa-light fa-sack-dollar text-teal-600"})],-1),xe={class:"leading-none font-semibold"},we={class:"bg-gray-50 px-2 py-1.5 shadow-sm rounded w-32 mx-6"},Ce=a("p",{class:"text-sm text-gray-400 leading-none mb-2 flex justify-between"},[a("span",null," Plastik "),a("i",{class:"fa-light fa-money-check-dollar text-sky-600"})],-1),ke={class:"leading-none font-semibold"},Pe={class:"bg-gray-50 px-2 py-1.5 shadow-sm rounded w-32"},Te=a("p",{class:"text-sm text-gray-400 leading-none mb-2 flex justify-between"},[a("span",null," Qarz "),a("i",{class:"fa-light fa-money-check-dollar-pen text-pink-600"})],-1),Se={class:"leading-none font-semibold"},De=D({__name:"SummSale",setup(p){const i=H();return i.getDayInfo(),(r,e)=>(m(),y("section",pe,[a("div",ve,[me,a("div",ye,b(+u(i).Summa.cash+ +u(i).Summa.debt+ +u(i).Summa.electron),1)]),ge,a("div",_e,[be,a("div",xe,b(u(i).Summa.cash),1)]),a("div",we,[Ce,a("div",ke,b(u(i).Summa.electron),1)]),a("div",Pe,[Te,a("div",Se,b(u(i).Summa.debt),1)])]))}});var j={exports:{}};(function(p,i){(function(r,e){p.exports=e()})(O,function(){var r={attachTo:function(e,t){if(e.scannerDetectionData!==void 0)throw new Error("onScan.js is already initialized for DOM element "+e);var n={onScan:function(s,o){},onScanError:function(s){},onKeyProcess:function(s,o){},onKeyDetect:function(s,o){},onPaste:function(s,o){},keyCodeMapper:function(s){return r.decodeKeyEvent(s)},onScanButtonLongPress:function(){},scanButtonKeyCode:!1,scanButtonLongPressTime:500,timeBeforeScanTest:100,avgTimeByChar:30,minLength:6,suffixKeyCodes:[9,13],prefixKeyCodes:[],ignoreIfFocusOn:!1,stopPropagation:!1,preventDefault:!1,captureEvents:!1,reactToKeydown:!0,reactToPaste:!1,singleScanQty:1};return t=this._mergeOptions(n,t),e.scannerDetectionData={options:t,vars:{firstCharTime:0,lastCharTime:0,accumulatedString:"",testTimer:!1,longPressTimeStart:0,longPressed:!1}},t.reactToPaste===!0&&e.addEventListener("paste",this._handlePaste,t.captureEvents),t.scanButtonKeyCode!==!1&&e.addEventListener("keyup",this._handleKeyUp,t.captureEvents),(t.reactToKeydown===!0||t.scanButtonKeyCode!==!1)&&e.addEventListener("keydown",this._handleKeyDown,t.captureEvents),this},detachFrom:function(e){e.scannerDetectionData.options.reactToPaste&&e.removeEventListener("paste",this._handlePaste),e.scannerDetectionData.options.scanButtonKeyCode!==!1&&e.removeEventListener("keyup",this._handleKeyUp),e.removeEventListener("keydown",this._handleKeyDown),e.scannerDetectionData=void 0},getOptions:function(e){return e.scannerDetectionData.options},setOptions:function(e,t){switch(e.scannerDetectionData.options.reactToPaste){case!0:t.reactToPaste===!1&&e.removeEventListener("paste",this._handlePaste);break;case!1:t.reactToPaste===!0&&e.addEventListener("paste",this._handlePaste);break}switch(e.scannerDetectionData.options.scanButtonKeyCode){case!1:t.scanButtonKeyCode!==!1&&e.addEventListener("keyup",this._handleKeyUp);break;default:t.scanButtonKeyCode===!1&&e.removeEventListener("keyup",this._handleKeyUp);break}return e.scannerDetectionData.options=this._mergeOptions(e.scannerDetectionData.options,t),this._reinitialize(e),this},decodeKeyEvent:function(e){var t=this._getNormalizedKeyNum(e);switch(!0){case(t>=48&&t<=90):case(t>=106&&t<=111):if(e.key!==void 0&&e.key!=="")return e.key;var n=String.fromCharCode(t);switch(e.shiftKey){case!1:n=n.toLowerCase();break;case!0:n=n.toUpperCase();break}return n;case(t>=96&&t<=105):return 0+(t-96)}return""},simulate:function(e,t){return this._reinitialize(e),Array.isArray(t)?t.forEach(function(n){var s={};(typeof n=="object"||typeof n=="function")&&n!==null?s=n:s.keyCode=parseInt(n);var o=new KeyboardEvent("keydown",s);document.dispatchEvent(o)}):this._validateScanCode(e,t),this},_reinitialize:function(e){var t=e.scannerDetectionData.vars;t.firstCharTime=0,t.lastCharTime=0,t.accumulatedString=""},_isFocusOnIgnoredElement:function(e){var t=e.scannerDetectionData.options.ignoreIfFocusOn;if(!t)return!1;var n=document.activeElement;if(Array.isArray(t)){for(var s=0;s<t.length;s++)if(n.matches(t[s])===!0)return!0}else if(n.matches(t))return!0;return!1},_validateScanCode:function(e,t){var n=e.scannerDetectionData,s=n.options,o=n.options.singleScanQty,c=n.vars.firstCharTime,f=n.vars.lastCharTime,v={},d;switch(!0){case t.length<s.minLength:v={message:"Receieved code is shorter then minimal length"};break;case f-c>t.length*s.avgTimeByChar:v={message:"Receieved code was not entered in time"};break;default:return s.onScan.call(e,t,o),d=new CustomEvent("scan",{detail:{scanCode:t,qty:o}}),e.dispatchEvent(d),r._reinitialize(e),!0}return v.scanCode=t,v.scanDuration=f-c,v.avgTimeByChar=s.avgTimeByChar,v.minLength=s.minLength,s.onScanError.call(e,v),d=new CustomEvent("scanError",{detail:v}),e.dispatchEvent(d),r._reinitialize(e),!1},_mergeOptions:function(e,t){var n={},s;for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s]);for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s]);return n},_getNormalizedKeyNum:function(e){return e.which||e.keyCode},_handleKeyDown:function(e){var t=r._getNormalizedKeyNum(e),n=this.scannerDetectionData.options,s=this.scannerDetectionData.vars,o=!1;if(n.onKeyDetect.call(this,t,e)!==!1&&!r._isFocusOnIgnoredElement(this)){if(n.scanButtonKeyCode!==!1&&t==n.scanButtonKeyCode){s.longPressed||(s.longPressTimer=setTimeout(n.onScanButtonLongPress,n.scanButtonLongPressTime,this),s.longPressed=!0);return}switch(!0){case(s.firstCharTime&&n.suffixKeyCodes.indexOf(t)!==-1):e.preventDefault(),e.stopImmediatePropagation(),o=!0;break;case(!s.firstCharTime&&n.prefixKeyCodes.indexOf(t)!==-1):e.preventDefault(),e.stopImmediatePropagation(),o=!1;break;default:var c=n.keyCodeMapper.call(this,e);if(c===null)return;s.accumulatedString+=c,n.preventDefault&&e.preventDefault(),n.stopPropagation&&e.stopImmediatePropagation(),o=!1;break}s.firstCharTime||(s.firstCharTime=Date.now()),s.lastCharTime=Date.now(),s.testTimer&&clearTimeout(s.testTimer),o?(r._validateScanCode(this,s.accumulatedString),s.testTimer=!1):s.testTimer=setTimeout(r._validateScanCode,n.timeBeforeScanTest,this,s.accumulatedString),n.onKeyProcess.call(this,c,e)}},_handlePaste:function(e){var t=this.scannerDetectionData.options,n=this.scannerDetectionData.vars,s=(event.clipboardData||window.clipboardData).getData("text");r._isFocusOnIgnoredElement(this)||(e.preventDefault(),t.stopPropagation&&e.stopImmediatePropagation(),t.onPaste.call(this,s,event),n.firstCharTime=0,n.lastCharTime=0,r._validateScanCode(this,s))},_handleKeyUp:function(e){if(!r._isFocusOnIgnoredElement(this)){var t=r._getNormalizedKeyNum(e);t==this.scannerDetectionData.options.scanButtonKeyCode&&(clearTimeout(this.scannerDetectionData.vars.longPressTimer),this.scannerDetectionData.vars.longPressed=!1)}},isScanInProgressFor:function(e){return e.scannerDetectionData.vars.firstCharTime>0},isAttachedTo:function(e){return e.scannerDetectionData!==void 0}};return r})})(j);const Ke=j.exports,$e=()=>{const p=_(null),i=_([]),r=_(!0),e=_(null);V(()=>p.value,o=>{var c=null;o==null||r.value==!1||(r.value=!1,o.includes(window.location.host)?c=o.slice(o.lastIndexOf("/")+1):c=o.replace("product",""),t(c))});function t(o){e.value==null&&(e.value=i.value.push([])-1);const c=i.value[e.value].find(f=>f.id==o);if(c)return c.count>c.totalCount&&c.totalCount++,r.value=!0;axios.get(`products/${o}`).then(({data:f})=>{r.value=!0,f.id?(f.totalCount=1,f.selled_price=f.price,i.value[e.value].push(f)):(i.value[e.value].length==0&&(i.value.splice(e.value,1),e.value=null),swal.fire({text:"Mahsulot mavjud emas!",showCancelButton:!1,timer:1e3}))})}document.scannerDetectionData==null&&Ke.attachTo(document);function n(o){setTimeout(()=>{p.value=o.detail.scanCode,console.log(p.value),setTimeout(()=>p.value=null)},50)}$(()=>document.addEventListener("scan",n)),A(()=>document.removeEventListener("scan",n));function s(o){o?document.removeEventListener("scan",n):document.addEventListener("scan",n)}return{getProductById:t,onFinished:s,textInBarcode:p,listProducts:i,blocker:r,activeList:e}},Le={name:"indexSale",class:"flex flex-col"},Be={class:"flex-between-center mb-3"},Ie=a("i",{class:"fa-light fa-arrow-up-from-dotted-line text-red-600 mr-4"},null,-1),Fe=a("span",{class:"px-4"},null,-1),Ne=a("i",{class:"fa-light fa-arrow-down-to-dotted-line text-blue-600 mr-4"},null,-1),Ee=["onSubmit"],je={class:"-mb-4 -mx-4 px-3 py-2 relative z-[100] bg-white text-gray-500"},ze=["onClick"],Ue=a("i",{class:"fa-solid fa-memo mr-1.5"},null,-1),Qe=D({__name:"IndexSale",setup(p){const{getProductById:i,onFinished:r,listProducts:e,blocker:t,activeList:n}=$e();X("getProductById",i);const s=R({searchInput:null});function o(){i(s.searchInput),s.searchInput=null}function c(){e.value.splice(n.value,1),n.value=null,t.value=!0,r(!1)}function f(){n.value=null,t.value=!0}function v(d){n.value=null,setTimeout(()=>n.value=d,150)}return(d,l)=>{const h=K("RouterLink"),x=K("RouterView");return m(),y("section",Le,[g(Q,{name:"fade"},{default:C(()=>[u(n)!=null&&u(e)[u(n)].length?(m(),T(he,{key:0,onClose:c,onOnrollup:f,onOnFinished:u(r),listProducts:u(e)[u(n)]},null,8,["onOnFinished","listProducts"])):L("",!0)]),_:1}),g(De),a("aside",Be,[a("div",null,[g(h,{to:"/soldproducts",class:"py-1.5 inline-block"},{default:C(()=>[Ie,k(" Sotilgan ")]),_:1}),Fe,g(h,{to:"/existproduct",class:"py-1.5 inline-block"},{default:C(()=>[Ne,k(" Do'kondagi ")]),_:1})]),a("form",{onSubmit:S(o,["prevent"])},[F(a("input",{type:"text",class:"text-input bg-inherit text-center text-gray-600","onUpdate:modelValue":l[0]||(l[0]=P=>s.searchInput=P),placeholder:"Sotish ID-XXX"},null,512),[[N,s.searchInput]])],40,Ee)]),g(x,{class:"h-full"}),a("main",je,[(m(!0),y(B,null,I(u(e),(P,w)=>(m(),y("button",{onClick:Me=>v(w),key:w,class:E([{"bg-pink-500 text-white":w==u(n)},"px-3 py-1 bg-gray-200 rounded-sm mr-3 border-b border-pink-600 transition-all"])},[Ue,k(" "+b(w+1),1)],10,ze))),128))])])}}});export{Qe as default};
