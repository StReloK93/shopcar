import{H as X,r as f,a as K,o as O,_ as R,b as h,e as v,f as a,l as $,v as Q,d as P,I as Y,p as U,J as q,q as I,A as G,t as D,F as Z,j as ee,m as L,u as k,i as z,g as T,k as te,E,G as M,w as ae,h as le,T as ne,n as S,K as V}from"./app.a40bcdf9.js";function J(n,s){return localStorage.getItem(n)!=null||localStorage.setItem(n,s),localStorage.getItem(n)}function ie(n,s){localStorage.setItem(n,s)}const H=X("listType",()=>{const n=f(JSON.parse(J("listType",!0))),s=K(()=>n.value);function l(c){ie("listType",c),n.value=JSON.parse(J("listType",!0))}return{type:n,setListType:l,getListType:s}}),se={setup(n){const s=f(n.params.value),l=f();return O(()=>{setTimeout(()=>l.value.focus())}),{value:s,inputNumber:l,getValue:()=>s.value}}},oe={class:"flex"},re=a("i",{class:"far fa-angle-left"},null,-1),de=[re],ce=a("i",{class:"far fa-angle-right"},null,-1),ue=[ce];function pe(n,s,l,c,b,m){return h(),v("section",oe,[a("button",{class:"px-3",onClick:s[0]||(s[0]=d=>c.value--)},de),$(a("input",{type:"number",ref:"inputNumber","onUpdate:modelValue":s[1]||(s[1]=d=>c.value=d),class:"outline-none w-10 flex-grow text-center"},null,512),[[Q,c.value]]),a("button",{class:"px-3",onClick:s[2]||(s[2]=d=>c.value++)},ue)])}const W=R(se,[["render",pe]]),me={setup(n){const s=f(n.params.value),l=f();return O(()=>{setTimeout(()=>l.value.focus())}),{value:s,inputNumber:l,getValue:()=>s.value}}},fe={class:"flex"};function ge(n,s,l,c,b,m){return h(),v("section",fe,[$(a("input",{ref:"inputNumber",type:"number","onUpdate:modelValue":s[0]||(s[0]=d=>c.value=d),class:"outline-none w-10 flex-grow text-center"},null,512),[[Q,c.value]])])}const A=R(me,[["render",ge]]),B=n=>(E("data-v-ae2f2446"),n=n(),M(),n),he={class:"flex-between-center bg-gray-100 border-b -m-2 mb-0"},be={class:"px-3 font-semibold"},_e=B(()=>a("i",{class:"far fa-times text-red-500"},null,-1)),ve=[_e],xe={class:"py-1.5 flex-between-center"},ye={class:"font-semibold text-pink-500"},we={key:0,class:"flex"},Ce=["onClick"],Ne=B(()=>a("i",{class:"fal fa-plus text-xs"},null,-1)),$e={class:"flex-grow"},ke={key:0,class:"mt-3 text-right"},Re=B(()=>a("i",{class:"far fa-trash text-pink-500 mr-2"},null,-1)),Ie=P({__name:"ProductName",props:{productName:Object,gridApi:Y,editable:{type:Boolean,default:!1}},emits:["close","deleteProduct"],setup(n,{emit:s}){const{productName:l,gridApi:c,editable:b}=n,m=U("getProductById",null),d=q(),u=I({size_name:null,sizes:[]}),w=K(()=>u.sizes.filter(e=>{if(l.products.find(x=>x.size_id==e.id)==null)return!0}));axios.get(`sizenames/${l.size_names_id}`).then(e=>{u.size_name=e.data.name,u.sizes=e.data.sizes});const C=f([{headerName:"ID",field:"id",width:65},{headerName:"O'lchami",field:"size.name",flex:1},{headerName:"Tan narxi",field:"original_price",editable:!0,width:115,cellEditor:A},{headerName:"Sotuv narxi",field:"price",editable:!0,width:115,cellEditor:A},{headerName:"Soni",field:"count",editable:!0,width:120,cellEditor:W},{headerName:"Kiritilgan sana",field:"created_at",editable:!0,width:115,cellRenderer:e=>moment(e.value).fromNow()},{width:50,headerName:"",onCellClicked:e=>y(e.data),cellRenderer:()=>'<i class="fa-sharp fa-light fa-qrcode text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{width:50,headerName:"",onCellClicked:e=>y(e.data),cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{width:50,headerName:"",hide:b==!1,onCellClicked:e=>_(e.data),cellRenderer:()=>'<i class="fal fa-trash text-pink-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:m==null,headerName:"",onCellClicked:e=>{m(e.data.id),setTimeout(()=>s("close"),250)},cellRenderer:()=>'<i class="fa-regular fa-bag-shopping text-orange-600"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]}]);function y(e){d.productName=null;const r={...e};r.count=1,setTimeout(()=>{d.productName={name:l.name,products:[r]}})}function _(e){swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(r=>{r.isConfirmed&&axios.delete(`products/${e.id}`).then(()=>{i.api.applyTransaction({remove:[e]}),l.products=l.products.filter(x=>x.id!=e.id),t(l)})})}function N(e){const r=l.products[l.products.length-1],x={product_names_id:l.id,size_id:e.id,original_price:r?r.original_price:0,price:r?r.price:0,count:1};axios.post("products",x).then(({data:g})=>{l.products.push(g),i.api.applyTransaction({add:[g]}),t(l)})}function o(e){const r=e.data;axios.put(`products/${r.id}`,r).then(()=>{t(l)})}function t(e){c.getRowNode(e.id).setData(e)}const i=I({api:null,columnApi:null});function p(e){i.api=e.api,i.columnApi=e.columnApi}return(e,r)=>{const x=G("AgGridVue");return h(),v("section",{onClick:r[3]||(r[3]=g=>e.$emit("close")),class:"full-absolute z-[70] p-8"},[a("main",{onClick:r[2]||(r[2]=te(()=>{},["stop"])),class:"h-full min-w-[630px] w-[900px] bg-white flex flex-col justify-between p-2"},[a("header",he,[a("div",be,D(n.productName.name),1),a("button",{onClick:r[0]||(r[0]=g=>e.$emit("close")),class:"px-4 py-2 hover:bg-gray-200"},ve)]),a("div",xe,[a("span",null,[a("span",ye,D(u.size_name),1)]),n.editable?(h(),v("div",we,[(h(!0),v(Z,null,ee(k(w),g=>(h(),v("button",{onClick:Xe=>N(g),class:"mini-button ml-3 text-gray-600"},[Ne,L(),a("span",null,D(g.name),1)],8,Ce))),256))])):z("",!0)]),a("aside",$e,[T(x,{class:"h-full ag-theme-alpine",getRowId:g=>g.data.id,rowData:n.productName.products,columnDefs:C.value,onCellValueChanged:o,onGridReady:p,animateRows:!0,undoRedoCellEditing:!0},null,8,["getRowId","rowData","columnDefs"])]),n.editable?(h(),v("div",ke,[a("button",{onClick:r[1]||(r[1]=g=>e.$emit("deleteProduct",n.productName)),class:"py-1 px-3 bg-gray-200 shadow border-b-2 border-pink-500 active:bg-gray-300"},[Re,L(" Mahsulotni o'chirish ")])])):z("",!0)])])}}});const Te=R(Ie,[["__scopeId","data-v-ae2f2446"]]),F=n=>(E("data-v-9bda9cdf"),n=n(),M(),n),Ae={class:"flex-grow flex flex-col"},De={class:"bg-white px-1 py-2 flex items-center justify-between"},Se={class:"flex items-center"},Ve=F(()=>a("label",{for:"searchInput"},null,-1)),ze=F(()=>a("i",{class:"fal fa-search text-sm mr-4 relative top-px"},null,-1)),Pe={class:"flex items-center"},qe={class:"mr-10 flex text-gray-500 items-center"},Ge={class:"mx-2"},Ee=F(()=>a("i",{class:"fa-regular fa-list-ul"},null,-1)),Me=[Ee],Be={class:"flex-grow"},Fe=P({__name:"ProductNames",props:["editable"],setup(n,{expose:s}){const l=f("contain"),c=f(null);axios.get("productnames").then(({data:t})=>c.value=t);const b=H(),m=q(),d=f(null),u=I({api:null,columnApi:null});s({agGrid:u});function w(t){d.value=null,setTimeout(()=>d.value=t.data)}function C(t){u.api=t.api,u.columnApi=t.columnApi}function y(t){swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(i=>{i.isConfirmed&&axios.put(`productnames/delete/${t.id}`,t).then(()=>{if(t.sells_sum_count){const p=u.api.getRowNode(t.id);t.products=[],p.setData(t)}else u.api.applyTransaction({remove:[t]});d.value=null})})}function _(t){const i=t.data.products.reduce((p,e)=>p+e.count,0);return l.value=="empty"?i==0:l.value=="contain"?i!=0:!0}function N(t){axios.put(`productnames/${t.data.id}`,t.data)}const o=f([{headerName:"Nomi",field:"name",flex:1,editable:!0},{sortable:!0,resizable:!0,headerName:"Soni",field:"products",width:85,cellRenderer:t=>t.value.reduce((i,p)=>i+p.count,0)},{sortable:!0,headerName:"Turi",field:"category.name",width:120},{sortable:!0,headerName:"Kiritilgan vaqt",field:"created_at",width:120,cellRenderer:t=>moment(t.value).fromNow()},{suppressMovable:!0,pinned:"right",width:50,headerName:"",onCellClicked:t=>{m.productQrName=null,setTimeout(()=>m.productQrName=t.data)},cellRenderer:()=>'<i class="fa-sharp fa-light fa-qrcode text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",headerName:"",width:50,cellClass:["hover:bg-white","cursor-pointer","text-center"],cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',onCellClicked:t=>{m.productName=null,setTimeout(()=>m.productName=t.data)}},{suppressMovable:!0,pinned:"right",headerName:"",width:50,cellClass:["hover:bg-white","cursor-pointer","text-center"],cellRenderer:()=>'<i class="fal fa-folder-open text-blue-500"></i>',onCellClicked:t=>w(t)}]);return(t,i)=>{const p=G("AgGridVue");return h(),v("main",Ae,[T(ne,{name:"fade"},{default:ae(()=>[d.value?(h(),le(Te,{key:0,gridApi:u.api,productName:d.value,editable:n.editable,onClose:i[0]||(i[0]=e=>d.value=null),onDeleteProduct:y},null,8,["gridApi","productName","editable"])):z("",!0)]),_:1}),a("section",De,[a("main",Se,[Ve,ze,a("input",{onInput:i[1]||(i[1]=e=>u.api.setQuickFilter(e.target.value)),id:"searchInput",type:"text",class:"py-0.5 bg-inherit w-full outline-none",placeholder:"Izlash"},null,32)]),a("main",Pe,[a("div",qe,[a("article",null,[a("label",{for:"alls",class:S(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":l.value=="all"}])}," Barchasi ",2),$(a("input",{hidden:"",id:"alls",type:"radio",name:"filte",onChange:i[2]||(i[2]=e=>u.api.onFilterChanged()),"onUpdate:modelValue":i[3]||(i[3]=e=>l.value=e),value:"all"},null,544),[[V,l.value]])]),a("article",Ge,[a("label",{for:"contains",class:S(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":l.value=="contain"}])}," Mavjud ",2),$(a("input",{hidden:"",id:"contains",type:"radio",name:"filte",onChange:i[4]||(i[4]=e=>u.api.onFilterChanged()),"onUpdate:modelValue":i[5]||(i[5]=e=>l.value=e),value:"contain"},null,544),[[V,l.value]])]),a("article",null,[a("label",{for:"emptys",class:S(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":l.value=="empty"}])}," Qolmagan ",2),$(a("input",{hidden:"",id:"emptys",type:"radio",name:"filte",onChange:i[6]||(i[6]=e=>u.api.onFilterChanged()),"onUpdate:modelValue":i[7]||(i[7]=e=>l.value=e),value:"empty"},null,544),[[V,l.value]])])]),a("button",{onClick:i[8]||(i[8]=e=>k(b).setListType(!k(b).type)),type:"button",class:"text-xl text-blue-600"},Me)])]),a("section",Be,[T(p,{class:"h-full ag-theme-alpine",getRowId:e=>e.data.id,rowData:c.value,columnDefs:o.value,animateRows:!0,onCellValueChanged:N,onGridReady:C,undoRedoCellEditing:!0,undoRedoCellEditingLimit:20,doesExternalFilterPass:_,isExternalFilterPresent:()=>l.value!="all"},null,8,["getRowId","rowData","columnDefs","isExternalFilterPresent"])])])}}});const Ze=R(Fe,[["__scopeId","data-v-9bda9cdf"]]),j=n=>(E("data-v-b1a69e5f"),n=n(),M(),n),je={class:"flex-grow flex flex-col"},Le={class:"bg-white px-1 py-2 flex items-center justify-between"},Je={class:"flex items-center"},Ke=j(()=>a("label",{for:"searchInput"},null,-1)),Oe=j(()=>a("i",{class:"fal fa-search text-sm mr-4 relative top-px"},null,-1)),Qe=j(()=>a("i",{class:"fa-light fa-list-tree"},null,-1)),Ue=[Qe],He={class:"flex-grow"},We=P({__name:"Products",props:{editable:{type:Boolean,default:!1}},setup(n,{expose:s}){const{editable:l}=n,c=H(),b=U("getProductById",null),m=q(),d=f();axios.get("products").then(({data:o})=>{d.value=o});const u=f([{suppressMovable:!0,pinned:"left",headerName:"ID",field:"id",width:70},{headerName:"Nomi",field:"product_names.name",flex:1,minWidth:140},{headerName:"O'lchami",field:"size.name",width:80},{headerName:"Tan narxi",field:"original_price",hide:l==!1,editable:l,width:115,cellEditor:A},{headerName:"Narxi",field:"price",editable:l,width:115,cellEditor:A},{headerName:"Soni",field:"count",editable:l,width:130,cellEditor:W},{headerName:"Kiritilgan sana",field:"created_at",editable:l,width:115,cellRenderer:o=>moment(o.value).fromNow()},{suppressMovable:!0,pinned:"right",width:50,headerName:"",cellRenderer:()=>'<i class="fa-sharp fa-light fa-qrcode text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,headerName:"",onCellClicked:o=>w(o.data),cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:l==!1,headerName:"",onCellClicked:o=>C(o.data),cellRenderer:()=>'<i class="fal fa-trash text-pink-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:b==null,headerName:"",onCellClicked:o=>b(o.data.id),cellRenderer:()=>'<i class="fa-regular fa-bag-shopping text-orange-600"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]}]);function w(o){m.productName=null;const t={...o};t.count=1,setTimeout(()=>{m.productName={name:o.product_names.name,products:[t]}})}function C(o){l!=!1&&swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(t=>{t.isConfirmed&&axios.delete(`products/${o.id}`).then(()=>{_.api.applyTransaction({remove:[o]})})})}function y(o){if(l==!1)return;const t=o.data;axios.put(`products/${t.id}`,t).then(()=>{})}const _=I({api:null,columnApi:null});function N(o){_.api=o.api,_.columnApi=o.columnApi}return s({productAgGrid:_}),(o,t)=>{const i=G("AgGridVue");return h(),v("aside",je,[a("section",Le,[a("main",Je,[Ke,Oe,a("input",{onInput:t[0]||(t[0]=p=>_.api.setQuickFilter(p.target.value)),id:"searchInput",type:"text",class:"py-0.5 bg-inherit w-full outline-none",placeholder:"Izlash"},null,32)]),a("button",{onClick:t[1]||(t[1]=p=>k(c).setListType(!k(c).type)),type:"button",class:"text-xl text-blue-600"},Ue)]),a("section",He,[T(i,{class:"h-full ag-theme-alpine",getRowId:p=>p.data.id,rowData:d.value,columnDefs:u.value,onCellValueChanged:y,onGridReady:N,animateRows:!0,undoRedoCellEditing:!0},null,8,["getRowId","rowData","columnDefs"])])])}}});const et=R(We,[["__scopeId","data-v-b1a69e5f"]]);export{Ze as P,et as a,J as g,ie as s,H as u};
