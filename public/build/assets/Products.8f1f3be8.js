import{G as X,r as m,a as K,o as O,_ as I,b as h,e as v,f as t,l as $,v as U,d as E,H as Y,p as Q,I as q,q as R,z as M,t as S,m as V,F as Z,j as ee,u as k,i as G,g as T,k as te,D as B,E as F,w as ae,h as le,T as ne,n as z,J as P}from"./app.0e1eeed2.js";function J(n,o){return localStorage.getItem(n)!=null||localStorage.setItem(n,o),localStorage.getItem(n)}function ie(n,o){localStorage.setItem(n,o)}const H=X("listType",()=>{const n=m(JSON.parse(J("listType",!0))),o=K(()=>n.value);function l(c){ie("listType",c),n.value=JSON.parse(J("listType",!0))}return{type:n,setListType:l,getListType:o}}),oe={setup(n){const o=m(n.params.value),l=m();return O(()=>{setTimeout(()=>l.value.focus())}),{value:o,inputNumber:l,getValue:()=>o.value}}},se={class:"flex"},re=t("i",{class:"far fa-angle-left"},null,-1),de=[re],ce=t("i",{class:"far fa-angle-right"},null,-1),ue=[ce];function pe(n,o,l,c,b,f){return h(),v("section",se,[t("button",{class:"px-3",onClick:o[0]||(o[0]=d=>c.value--)},de),$(t("input",{type:"number",ref:"inputNumber","onUpdate:modelValue":o[1]||(o[1]=d=>c.value=d),class:"outline-none w-10 flex-grow text-center"},null,512),[[U,c.value]]),t("button",{class:"px-3",onClick:o[2]||(o[2]=d=>c.value++)},ue)])}const W=I(oe,[["render",pe]]),me={setup(n){const o=m(n.params.value),l=m();return O(()=>{setTimeout(()=>l.value.focus())}),{value:o,inputNumber:l,getValue:()=>o.value}}},fe={class:"flex"};function ge(n,o,l,c,b,f){return h(),v("section",fe,[$(t("input",{ref:"inputNumber",type:"number","onUpdate:modelValue":o[0]||(o[0]=d=>c.value=d),class:"outline-none w-10 flex-grow text-center"},null,512),[[U,c.value]])])}const D=I(me,[["render",ge]]),A=n=>(B("data-v-57715cda"),n=n(),F(),n),he={class:"flex-between-center bg-gray-100 border-b -m-2 mb-0"},be={class:"px-3 font-semibold"},_e=A(()=>t("i",{class:"far fa-times text-red-500"},null,-1)),ve=[_e],xe={class:"py-1.5 flex-between-center"},ye=A(()=>t("i",{class:"fa-light fa-ruler-triangle"},null,-1)),we={class:"font-semibold text-pink-500"},Ce={key:0,class:"flex"},Ne=["onClick"],$e=A(()=>t("i",{class:"fal fa-plus text-xs"},null,-1)),ke={class:"flex-grow"},Ie={key:0,class:"mt-3 text-right"},Re=A(()=>t("i",{class:"far fa-trash text-pink-500 mr-2"},null,-1)),Te=E({__name:"ProductName",props:{productName:Object,gridApi:Y,editable:{type:Boolean,default:!1}},emits:["close","deleteProduct"],setup(n,{emit:o}){const{productName:l,gridApi:c,editable:b}=n,f=Q("getProductById",null),d=q(),u=R({size_name:null,sizes:[]}),y=K(()=>u.sizes.filter(e=>{if(l.products.find(x=>x.size_id==e.id)==null)return!0}));axios.get(`sizenames/${l.size_names_id}`).then(e=>{u.size_name=e.data.name,u.sizes=e.data.sizes});const w=m([{headerName:"ID",field:"id",width:65},{headerName:"O'lchami",field:"size.name",flex:1},{headerName:"Tan narxi",field:"original_price",editable:!0,width:115,cellEditor:D},{headerName:"Sotuv narxi",field:"price",editable:!0,width:115,cellEditor:D},{headerName:"Soni",field:"count",editable:!0,width:120,cellEditor:W},{headerName:"Kiritilgan sana",field:"created_at",editable:!0,width:115,cellRenderer:e=>moment(e.value).fromNow()},{width:50,headerName:"",onCellClicked:e=>C(e.data),cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{width:50,headerName:"",hide:b==!1,onCellClicked:e=>_(e.data),cellRenderer:()=>'<i class="fal fa-trash text-pink-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:f==null,headerName:"",onCellClicked:e=>{f(e.data.id),setTimeout(()=>o("close"),250)},cellRenderer:()=>'<i class="fa-regular fa-bag-shopping text-orange-600"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]}]);function C(e){d.productName=null;const r={...e};r.count=1,setTimeout(()=>{d.productName={name:l.name,products:[r]}})}function _(e){swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(r=>{r.isConfirmed&&axios.delete(`products/${e.id}`).then(()=>{i.api.applyTransaction({remove:[e]}),l.products=l.products.filter(x=>x.id!=e.id),a(l)})})}function N(e){const r=l.products[l.products.length-1],x={product_names_id:l.id,size_id:e.id,original_price:r?r.original_price:0,price:r?r.price:0,count:1};axios.post("products",x).then(({data:g})=>{l.products.push(g),i.api.applyTransaction({add:[g]}),a(l)})}function s(e){const r=e.data;axios.put(`products/${r.id}`,r).then(()=>{a(l)})}function a(e){c.getRowNode(e.id).setData(e)}const i=R({api:null,columnApi:null});function p(e){i.api=e.api,i.columnApi=e.columnApi}return(e,r)=>{const x=M("AgGridVue");return h(),v("section",{onClick:r[3]||(r[3]=g=>e.$emit("close")),class:"full-absolute z-[70] p-8"},[t("main",{onClick:r[2]||(r[2]=te(()=>{},["stop"])),class:"h-full min-w-[630px] w-[900px] bg-white flex flex-col justify-between p-2"},[t("header",he,[t("div",be,S(n.productName.name),1),t("button",{onClick:r[0]||(r[0]=g=>e.$emit("close")),class:"px-4 py-2 hover:bg-gray-200"},ve)]),t("div",xe,[t("span",null,[ye,V(" - "),t("span",we,S(u.size_name),1)]),n.editable?(h(),v("div",Ce,[(h(!0),v(Z,null,ee(k(y),g=>(h(),v("button",{onClick:Ye=>N(g),class:"bg-gray-200 shadow rounded-sm border-b-2 border-pink-500 w-14 px-2 py-0.5 ml-2 flex-between-center active:bg-gray-200 hover:bg-gray-300"},[$e,V(),t("span",null,S(g.name),1)],8,Ne))),256))])):G("",!0)]),t("aside",ke,[T(x,{class:"h-full ag-theme-alpine",getRowId:g=>g.data.id,rowData:n.productName.products,columnDefs:w.value,onCellValueChanged:s,onGridReady:p,animateRows:!0,undoRedoCellEditing:!0},null,8,["getRowId","rowData","columnDefs"])]),n.editable?(h(),v("div",Ie,[t("button",{onClick:r[1]||(r[1]=g=>e.$emit("deleteProduct",n.productName)),class:"py-1 px-3 bg-gray-200 shadow border-b-2 border-pink-500 active:bg-gray-300"},[Re,V(" Mahsulotni o'chirish ")])])):G("",!0)])])}}});const De=I(Te,[["__scopeId","data-v-57715cda"]]),j=n=>(B("data-v-3bd8d7eb"),n=n(),F(),n),Ae={class:"flex-grow flex flex-col"},Se={class:"bg-white px-1 py-2 flex items-center justify-between"},Ve={class:"flex items-center"},ze=j(()=>t("label",{for:"searchInput"},null,-1)),Pe=j(()=>t("i",{class:"fal fa-search text-sm mr-4 relative top-px"},null,-1)),Ge={class:"flex items-center"},Ee={class:"mr-10 flex text-gray-500 items-center"},qe={class:"mx-2"},Me=j(()=>t("i",{class:"fa-regular fa-list-ul"},null,-1)),Be=[Me],Fe={class:"flex-grow"},je=E({__name:"ProductNames",props:["editable"],setup(n,{expose:o}){const l=m("contain"),c=m(null);axios.get("productnames").then(({data:a})=>c.value=a);const b=H(),f=q(),d=m(null),u=R({api:null,columnApi:null});o({agGrid:u});function y(a){d.value=null,setTimeout(()=>d.value=a.data)}function w(a){u.api=a.api,u.columnApi=a.columnApi}function C(a){console.log(a),swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(i=>{i.isConfirmed&&axios.put(`productnames/delete/${a.id}`,a).then(()=>{if(a.sells_sum_count){const p=u.api.getRowNode(a.id);a.products=[],p.setData(a)}else u.api.applyTransaction({remove:[a]});d.value=null})})}function _(a){const i=a.data.products.reduce((p,e)=>p+e.count,0);return l.value=="empty"?i==0:l.value=="contain"?i!=0:!0}function N(a){axios.put(`productnames/${a.data.id}`,a.data)}const s=m([{headerName:"Nomi",field:"name",flex:1,editable:!0},{sortable:!0,resizable:!0,headerName:"Soni",field:"products",width:85,cellRenderer:a=>a.value.reduce((i,p)=>i+p.count,0)},{sortable:!0,headerName:"Turi",field:"category.name",width:120},{sortable:!0,headerName:"Kiritilgan vaqt",field:"created_at",width:120,cellRenderer:a=>moment(a.value).fromNow()},{suppressMovable:!0,pinned:"right",headerName:"",width:50,cellClass:["hover:bg-white","cursor-pointer","text-center"],cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',onCellClicked:a=>{f.productName=null,setTimeout(()=>f.productName=a.data)}},{suppressMovable:!0,pinned:"right",headerName:"",width:50,cellClass:["hover:bg-white","cursor-pointer","text-center"],cellRenderer:()=>'<i class="fal fa-folder-open text-blue-500"></i>',onCellClicked:a=>y(a)}]);return(a,i)=>{const p=M("AgGridVue");return h(),v("main",Ae,[T(ne,{name:"fade"},{default:ae(()=>[d.value?(h(),le(De,{key:0,gridApi:u.api,productName:d.value,editable:n.editable,onClose:i[0]||(i[0]=e=>d.value=null),onDeleteProduct:C},null,8,["gridApi","productName","editable"])):G("",!0)]),_:1}),t("section",Se,[t("main",Ve,[ze,Pe,t("input",{onInput:i[1]||(i[1]=e=>u.api.setQuickFilter(e.target.value)),id:"searchInput",type:"text",class:"py-0.5 bg-inherit w-full outline-none",placeholder:"Izlash"},null,32)]),t("main",Ge,[t("div",Ee,[t("article",null,[t("label",{for:"alls",class:z(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":l.value=="all"}])}," Barchasi ",2),$(t("input",{hidden:"",id:"alls",type:"radio",name:"filte",onChange:i[2]||(i[2]=e=>u.api.onFilterChanged()),"onUpdate:modelValue":i[3]||(i[3]=e=>l.value=e),value:"all"},null,544),[[P,l.value]])]),t("article",qe,[t("label",{for:"contains",class:z(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":l.value=="contain"}])}," Mavjud ",2),$(t("input",{hidden:"",id:"contains",type:"radio",name:"filte",onChange:i[4]||(i[4]=e=>u.api.onFilterChanged()),"onUpdate:modelValue":i[5]||(i[5]=e=>l.value=e),value:"contain"},null,544),[[P,l.value]])]),t("article",null,[t("label",{for:"emptys",class:z(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":l.value=="empty"}])}," Qolmagan ",2),$(t("input",{hidden:"",id:"emptys",type:"radio",name:"filte",onChange:i[6]||(i[6]=e=>u.api.onFilterChanged()),"onUpdate:modelValue":i[7]||(i[7]=e=>l.value=e),value:"empty"},null,544),[[P,l.value]])])]),t("button",{onClick:i[8]||(i[8]=e=>k(b).setListType(!k(b).type)),type:"button",class:"text-xl text-blue-600"},Be)])]),t("section",Fe,[T(p,{class:"h-full ag-theme-alpine",getRowId:e=>e.data.id,rowData:c.value,columnDefs:s.value,animateRows:!0,onCellValueChanged:N,onGridReady:w,undoRedoCellEditing:!0,undoRedoCellEditingLimit:20,doesExternalFilterPass:_,isExternalFilterPresent:()=>l.value!="all"},null,8,["getRowId","rowData","columnDefs","isExternalFilterPresent"])])])}}});const et=I(je,[["__scopeId","data-v-3bd8d7eb"]]),L=n=>(B("data-v-306e2478"),n=n(),F(),n),Le={class:"flex-grow flex flex-col"},Je={class:"bg-white px-1 py-2 flex items-center justify-between"},Ke={class:"flex items-center"},Oe=L(()=>t("label",{for:"searchInput"},null,-1)),Ue=L(()=>t("i",{class:"fal fa-search text-sm mr-4 relative top-px"},null,-1)),Qe=L(()=>t("i",{class:"fa-light fa-list-tree"},null,-1)),He=[Qe],We={class:"flex-grow"},Xe=E({__name:"Products",props:{editable:{type:Boolean,default:!1}},setup(n,{expose:o}){const{editable:l}=n,c=H(),b=Q("getProductById",null),f=q(),d=m();axios.get("products").then(({data:s})=>{d.value=s});const u=m([{suppressMovable:!0,pinned:"left",headerName:"ID",field:"id",width:70},{headerName:"Nomi",field:"product_names.name",flex:1,minWidth:140},{headerName:"O'lchami",field:"size.name",width:80},{headerName:"Tan narxi",field:"original_price",hide:l==!1,editable:l,width:115,cellEditor:D},{headerName:"Narxi",field:"price",editable:l,width:115,cellEditor:D},{headerName:"Soni",field:"count",editable:l,width:130,cellEditor:W},{headerName:"Kiritilgan sana",field:"created_at",editable:l,width:115,cellRenderer:s=>moment(s.value).fromNow()},{suppressMovable:!0,pinned:"right",width:50,headerName:"",onCellClicked:s=>y(s.data),cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:l==!1,headerName:"",onCellClicked:s=>w(s.data),cellRenderer:()=>'<i class="fal fa-trash text-pink-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:b==null,headerName:"",onCellClicked:s=>b(s.data.id),cellRenderer:()=>'<i class="fa-regular fa-bag-shopping text-orange-600"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]}]);function y(s){f.productName=null;const a={...s};a.count=1,setTimeout(()=>{f.productName={name:s.product_names.name,products:[a]}})}function w(s){l!=!1&&swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(a=>{a.isConfirmed&&axios.delete(`products/${s.id}`).then(()=>{_.api.applyTransaction({remove:[s]})})})}function C(s){if(l==!1)return;const a=s.data;axios.put(`products/${a.id}`,a).then(()=>{})}const _=R({api:null,columnApi:null});function N(s){_.api=s.api,_.columnApi=s.columnApi}return o({productAgGrid:_}),(s,a)=>{const i=M("AgGridVue");return h(),v("aside",Le,[t("section",Je,[t("main",Ke,[Oe,Ue,t("input",{onInput:a[0]||(a[0]=p=>_.api.setQuickFilter(p.target.value)),id:"searchInput",type:"text",class:"py-0.5 bg-inherit w-full outline-none",placeholder:"Izlash"},null,32)]),t("button",{onClick:a[1]||(a[1]=p=>k(c).setListType(!k(c).type)),type:"button",class:"text-xl text-blue-600"},He)]),t("section",We,[T(i,{class:"h-full ag-theme-alpine",getRowId:p=>p.data.id,rowData:d.value,columnDefs:u.value,onCellValueChanged:C,onGridReady:N,animateRows:!0,undoRedoCellEditing:!0},null,8,["getRowId","rowData","columnDefs"])])])}}});const tt=I(Xe,[["__scopeId","data-v-306e2478"]]);export{et as P,tt as a,H as u};
