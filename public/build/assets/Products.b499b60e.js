import{B as Y,r as m,c as Q,o as U,_ as k,a as _,b as x,e as a,k as $,v as J,d as V,m as K,G as z,x as F,z as A,t as S,F as Z,i as ee,l as j,u as b,h as P,f as R,j as te,D as G,E as q,s as O,w as ae,g as le,T as ne,n as T,H as D}from"./app.eed0d982.js";import{G as H,a as oe}from"./useGridProductStore.df2f0e79.js";function L(n,e){return localStorage.getItem(n)!=null||localStorage.setItem(n,e),localStorage.getItem(n)}function se(n,e){localStorage.setItem(n,e)}const W=Y("listType",()=>{const n=m(JSON.parse(L("listType",!0))),e=Q(()=>n.value);function s(i){se("listType",i),n.value=JSON.parse(L("listType",!0))}return{type:n,setListType:s,getListType:e}}),ie={setup(n){const e=m(n.params.value),s=m();return U(()=>{setTimeout(()=>s.value.focus())}),{value:e,inputNumber:s,getValue:()=>e.value}}},re={class:"flex"},de=a("i",{class:"far fa-angle-left"},null,-1),ce=[de],ue=a("i",{class:"far fa-angle-right"},null,-1),pe=[ue];function me(n,e,s,i,f,p){return _(),x("section",re,[a("button",{class:"px-3",onClick:e[0]||(e[0]=c=>i.value--)},ce),$(a("input",{type:"number",ref:"inputNumber","onUpdate:modelValue":e[1]||(e[1]=c=>i.value=c),class:"outline-none w-10 flex-grow text-center"},null,512),[[J,i.value]]),a("button",{class:"px-3",onClick:e[2]||(e[2]=c=>i.value++)},pe)])}const X=k(ie,[["render",me]]),fe={setup(n){const e=m(n.params.value),s=m();return U(()=>{setTimeout(()=>s.value.focus())}),{value:e,inputNumber:s,getValue:()=>e.value}}},he={class:"flex"};function ge(n,e,s,i,f,p){return _(),x("section",he,[$(a("input",{ref:"inputNumber",type:"number","onUpdate:modelValue":e[0]||(e[0]=c=>i.value=c),class:"outline-none w-10 flex-grow text-center"},null,512),[[J,i.value]])])}const I=k(fe,[["render",ge]]),E=n=>(G("data-v-a041598d"),n=n(),q(),n),be={class:"flex-between-center bg-gray-100 border-b -m-2 mb-0"},_e={class:"px-3 font-semibold"},xe=E(()=>a("i",{class:"far fa-times text-red-500"},null,-1)),ve=[xe],ye={class:"py-1.5 flex-between-center"},we={class:"font-semibold text-pink-500"},Ce={key:0,class:"flex"},Ne=["onClick"],$e=E(()=>a("i",{class:"fal fa-plus text-xs"},null,-1)),ke={class:"flex-grow"},Re={key:0,class:"mt-3 text-right"},Ie=E(()=>a("i",{class:"far fa-trash text-pink-500 mr-2"},null,-1)),Se=V({__name:"ProductName",props:{productName:Object,editable:{type:Boolean,default:!1}},emits:["close","deleteProduct"],setup(n,{emit:e}){const{productName:s,editable:i}=n,f=H(),p=K("getProductById",null),c=z(),v=F({size_name:null,sizes:[]}),y=Q(()=>v.sizes.filter(t=>{if(s.products.find(h=>h.size_id==t.id)==null)return!0}));axios.get(`sizenames/${s.size_names_id}`).then(t=>{v.size_name=t.data.name,v.sizes=t.data.sizes});const C=m([{headerName:"ID",field:"id",width:65},{headerName:"O'lchami",field:"size.name",flex:1},{headerName:"Tan narxi",field:"original_price",editable:i,width:115,cellEditor:I},{headerName:"Sotuv narxi",field:"price",editable:i,width:115,cellEditor:I},{headerName:"Soni",field:"count",editable:i,width:120,cellEditor:X},{headerName:"Kiritilgan sana",field:"created_at",editable:i,width:115,cellRenderer:t=>moment(t.value).fromNow()},{width:50,headerName:"",onCellClicked:t=>w(t.data,"productQrName"),cellRenderer:()=>'<i class="fa-sharp fa-light fa-qrcode text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{width:50,headerName:"",onCellClicked:t=>w(t.data,"productName"),cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{width:50,headerName:"",hide:i==!1,onCellClicked:t=>N(t.data),cellRenderer:()=>'<i class="fal fa-trash text-pink-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:p==null,headerName:"",onCellClicked:t=>{p(t.data.id),setTimeout(()=>e("close"),250)},cellRenderer:()=>'<i class="fa-regular fa-bag-shopping text-orange-600"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]}]);function w(t,d){c[d]=null;const h={...t};h.count=1,setTimeout(()=>{c[d]={name:s.name,products:[h]}})}function N(t){swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(d=>{d.isConfirmed&&axios.delete(`products/${t.id}`).then(()=>{o.api.applyTransaction({remove:[t]}),s.products=s.products.filter(h=>h.id!=t.id),f.update(s)})})}function r(t){const d=s.products[s.products.length-1],h={product_names_id:s.id,size_id:t.id,original_price:d?d.original_price:0,price:d?d.price:0,count:1};axios.post("products",h).then(({data:g})=>{s.products.push(g),o.api.applyTransaction({add:[g]}),f.update(s)})}function l(t){const d=t.data;axios.put(`products/${d.id}`,d).then(()=>{f.update(s)})}const o=F({api:null,columnApi:null});function u(t){o.api=t.api,o.columnApi=t.columnApi}return(t,d)=>{const h=A("AgGridVue");return _(),x("section",{onClick:d[3]||(d[3]=g=>e("close")),class:"full-absolute z-[70] p-8"},[a("main",{onClick:d[2]||(d[2]=te(()=>{},["stop"])),class:"h-full min-w-[630px] w-[900px] bg-white flex flex-col justify-between p-2"},[a("header",be,[a("div",_e,S(n.productName.name),1),a("button",{onClick:d[0]||(d[0]=g=>t.$emit("close")),class:"px-4 py-2 hover:bg-gray-200"},ve)]),a("div",ye,[a("span",null,[a("span",we,S(v.size_name),1)]),n.editable?(_(),x("div",Ce,[(_(!0),x(Z,null,ee(b(y),g=>(_(),x("button",{onClick:Ye=>r(g),class:"mini-button ml-3 text-gray-600"},[$e,j(),a("span",null,S(g.name),1)],8,Ne))),256))])):P("",!0)]),a("aside",ke,[R(h,{class:"h-full ag-theme-alpine",headerHeight:30,getRowId:g=>g.data.id,rowData:n.productName.products,columnDefs:C.value,onCellValueChanged:l,onGridReady:u,animateRows:!0,undoRedoCellEditing:!0},null,8,["getRowId","rowData","columnDefs"])]),n.editable?(_(),x("div",Re,[a("button",{onClick:d[1]||(d[1]=g=>e("deleteProduct",n.productName)),class:"py-1 px-3 bg-gray-200 shadow border-b-2 border-pink-500 active:bg-gray-300"},[Ie,j(" Mahsulotni o'chirish ")])])):P("",!0)])])}}});const Te=k(Se,[["__scopeId","data-v-a041598d"]]),M=n=>(G("data-v-fd00acc3"),n=n(),q(),n),De={class:"flex-grow flex flex-col"},Pe={class:"bg-white px-1 py-2 flex items-center justify-between"},Ve={class:"flex items-center"},ze=M(()=>a("label",{for:"searchInput"},null,-1)),Ae=M(()=>a("i",{class:"fal fa-search text-sm mr-4 relative top-px"},null,-1)),Ge={class:"flex items-center"},qe={class:"mr-10 flex text-gray-500 items-center"},Ee={class:"mx-2"},Me=M(()=>a("i",{class:"fa-regular fa-list-ul"},null,-1)),Be=[Me],Fe={class:"flex-grow"},je=V({__name:"ProductNames",props:["editable"],setup(n){const e=m("contain"),s=m(null);axios.get("productnames").then(({data:l})=>s.value=l);const i=H(),f=W(),p=z(),c=m(null);function v(l){c.value=null,setTimeout(()=>c.value=l.data)}function y(l){swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(o=>{o.isConfirmed&&axios.put(`productnames/delete/${l.id}`,l).then(()=>{if(l.sells_sum_count){const u=i.api.getRowNode(l.id);l.products=[],u.setData(l)}else i.api.applyTransaction({remove:[l]});c.value=null})})}function C(l){const o=l.data.products.reduce((u,t)=>u+t.count,0);return e.value=="empty"?o==0:e.value=="contain"?o!=0:!0}function w(l){axios.put(`productnames/${l.data.id}`,l.data)}const N=m([{headerName:"Nomi",field:"name",flex:1,editable:!0},{sortable:!0,resizable:!0,headerName:"Soni",field:"products",width:85,cellRenderer:l=>l.value.reduce((o,u)=>o+u.count,0)},{sortable:!0,headerName:"Turi",field:"category.name",width:120},{sortable:!0,headerName:"Kiritilgan vaqt",field:"created_at",width:120,cellRenderer:l=>moment(l.value).fromNow()},{suppressMovable:!0,pinned:"right",width:50,headerName:"",onCellClicked:l=>{p.productQrName=null,setTimeout(()=>p.productQrName=l.data)},cellRenderer:()=>'<i class="fa-sharp fa-light fa-qrcode text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",headerName:"",width:50,cellClass:["hover:bg-white","cursor-pointer","text-center"],cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',onCellClicked:l=>{p.productName=null,setTimeout(()=>p.productName=l.data)}},{suppressMovable:!0,pinned:"right",headerName:"",width:50,cellClass:["hover:bg-white","cursor-pointer","text-center"],cellRenderer:()=>'<i class="fal fa-folder-open text-blue-500"></i>',onCellClicked:l=>v(l)}]);function r(l){i.api=l.api,i.columnApi=l.columnApi}return O(()=>{i.api=null,i.columnApi=null}),(l,o)=>{const u=A("AgGridVue");return _(),x("main",De,[R(ne,{name:"fade"},{default:ae(()=>[c.value?(_(),le(Te,{key:0,productName:c.value,editable:n.editable,onClose:o[0]||(o[0]=t=>c.value=null),onDeleteProduct:y},null,8,["productName","editable"])):P("",!0)]),_:1}),a("section",Pe,[a("main",Ve,[ze,Ae,a("input",{onInput:o[1]||(o[1]=t=>b(i).api.setQuickFilter(t.target.value)),id:"searchInput",type:"text",class:"py-0.5 bg-inherit w-full outline-none",placeholder:"Izlash"},null,32)]),a("main",Ge,[a("div",qe,[a("article",null,[a("label",{for:"alls",class:T(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":e.value=="all"}])}," Barchasi ",2),$(a("input",{hidden:"",id:"alls",type:"radio",name:"filte",onChange:o[2]||(o[2]=t=>b(i).api.onFilterChanged()),"onUpdate:modelValue":o[3]||(o[3]=t=>e.value=t),value:"all"},null,544),[[D,e.value]])]),a("article",Ee,[a("label",{for:"contains",class:T(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":e.value=="contain"}])}," Mavjud ",2),$(a("input",{hidden:"",id:"contains",type:"radio",name:"filte",onChange:o[4]||(o[4]=t=>b(i).api.onFilterChanged()),"onUpdate:modelValue":o[5]||(o[5]=t=>e.value=t),value:"contain"},null,544),[[D,e.value]])]),a("article",null,[a("label",{for:"emptys",class:T(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":e.value=="empty"}])}," Qolmagan ",2),$(a("input",{hidden:"",id:"emptys",type:"radio",name:"filte",onChange:o[6]||(o[6]=t=>b(i).api.onFilterChanged()),"onUpdate:modelValue":o[7]||(o[7]=t=>e.value=t),value:"empty"},null,544),[[D,e.value]])])]),a("button",{onClick:o[8]||(o[8]=t=>b(f).setListType(!b(f).type)),type:"button",class:"text-xl text-blue-600"},Be)])]),a("section",Fe,[R(u,{class:"h-full ag-theme-alpine",headerHeight:30,getRowId:t=>t.data.id,rowData:s.value,columnDefs:N.value,animateRows:!0,onCellValueChanged:w,onGridReady:r,undoRedoCellEditing:!0,undoRedoCellEditingLimit:20,doesExternalFilterPass:C,isExternalFilterPresent:()=>e.value!="all"},null,8,["getRowId","rowData","columnDefs","isExternalFilterPresent"])])])}}});const tt=k(je,[["__scopeId","data-v-fd00acc3"]]),B=n=>(G("data-v-fdca8ab6"),n=n(),q(),n),Le={class:"flex-grow flex flex-col"},Qe={class:"bg-white px-1 py-2 flex items-center justify-between"},Ue={class:"flex items-center"},Je=B(()=>a("label",{for:"searchInput"},null,-1)),Ke=B(()=>a("i",{class:"fal fa-search text-sm mr-4 relative top-px"},null,-1)),Oe=B(()=>a("i",{class:"fa-light fa-list-tree"},null,-1)),He=[Oe],We={class:"flex-grow"},Xe=V({__name:"Products",props:{editable:{type:Boolean,default:!1}},setup(n){const{editable:e}=n,s=oe(),i=W(),f=K("getProductById",null),p=z(),c=m();axios.get("products").then(({data:r})=>{c.value=r});const v=m([{suppressMovable:!0,pinned:"left",headerName:"ID",field:"id",width:70},{headerName:"Nomi",field:"product_names.name",flex:1,minWidth:140},{headerName:"O'lchami",field:"size.name",width:80},{headerName:"Tan narxi",field:"original_price",hide:e==!1,editable:e,width:115,cellEditor:I},{headerName:"Narxi",field:"price",editable:e,width:115,cellEditor:I},{headerName:"Soni",field:"count",editable:e,width:130,cellEditor:X},{headerName:"Kiritilgan sana",field:"created_at",editable:e,width:115,cellRenderer:r=>moment(r.value).fromNow()},{suppressMovable:!0,pinned:"right",width:50,headerName:"",onCellClicked:r=>y(r.data,"productQrName"),cellRenderer:()=>'<i class="fa-sharp fa-light fa-qrcode text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,headerName:"",onCellClicked:r=>y(r.data,"productName"),cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:e==!1,headerName:"",onCellClicked:r=>C(r.data),cellRenderer:()=>'<i class="fal fa-trash text-pink-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:f==null,headerName:"",onCellClicked:r=>f(r.data.id),cellRenderer:()=>'<i class="fa-regular fa-bag-shopping text-orange-600"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]}]);function y(r,l){p[l]=null;const o={...r};o.count=1,setTimeout(()=>{p[l]={name:r.product_names.name,products:[o]}})}function C(r){e!=!1&&swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(l=>{l.isConfirmed&&axios.delete(`products/${r.id}`).then(()=>{s.deleteRow(r)})})}function w(r){if(e==!1)return;const l=r.data;axios.put(`products/${l.id}`,l)}function N(r){s.api=r.api,s.columnApi=r.columnApi}return O(()=>{s.api=null,s.columnApi=null}),(r,l)=>{const o=A("AgGridVue");return _(),x("aside",Le,[a("section",Qe,[a("main",Ue,[Je,Ke,a("input",{onInput:l[0]||(l[0]=u=>b(s).api.setQuickFilter(u.target.value)),id:"searchInput",type:"text",class:"py-0.5 bg-inherit w-full outline-none",placeholder:"Izlash"},null,32)]),a("button",{onClick:l[1]||(l[1]=u=>b(i).setListType(!b(i).type)),type:"button",class:"text-xl text-blue-600"},He)]),a("section",We,[R(o,{class:"h-full ag-theme-alpine",headerHeight:30,getRowId:u=>u.data.id,rowData:c.value,columnDefs:v.value,onCellValueChanged:w,onGridReady:N,animateRows:!0,undoRedoCellEditing:!0},null,8,["getRowId","rowData","columnDefs"])])])}}});const at=k(Xe,[["__scopeId","data-v-fdca8ab6"]]);export{tt as P,at as a,L as g,se as s,W as u};
