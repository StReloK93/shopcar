import{D as O,r as m,a as P,o as B,_ as F,b as h,e as v,f as t,l as $,v as j,d as E,G as U,p as L,E as q,q as R,z as G,t as A,m as I,F as Q,j as H,u as k,i as S,g as T,k as W,w as X,h as Y,T as Z,n as V,H as z}from"./app.f554c489.js";function M(i,o){return localStorage.getItem(i)!=null||localStorage.setItem(i,o),localStorage.getItem(i)}function ee(i,o){localStorage.setItem(i,o)}const J=O("listType",()=>{const i=m(JSON.parse(M("listType",!0))),o=P(()=>i.value);function l(u){ee("listType",u),i.value=JSON.parse(M("listType",!0))}return{type:i,setListType:l,getListType:o}}),te={setup(i){const o=m(i.params.value),l=m();return B(()=>{setTimeout(()=>l.value.focus())}),{value:o,inputNumber:l,getValue:()=>o.value}}},ae={class:"flex"},le=t("i",{class:"far fa-angle-left"},null,-1),ne=[le],ie=t("i",{class:"far fa-angle-right"},null,-1),oe=[ie];function se(i,o,l,u,b,f){return h(),v("section",ae,[t("button",{class:"px-3",onClick:o[0]||(o[0]=d=>u.value--)},ne),$(t("input",{type:"number",ref:"inputNumber","onUpdate:modelValue":o[1]||(o[1]=d=>u.value=d),class:"outline-none w-10 flex-grow text-center"},null,512),[[j,u.value]]),t("button",{class:"px-3",onClick:o[2]||(o[2]=d=>u.value++)},oe)])}const K=F(te,[["render",se]]),re={setup(i){const o=m(i.params.value),l=m();return B(()=>{setTimeout(()=>l.value.focus())}),{value:o,inputNumber:l,getValue:()=>o.value}}},de={class:"flex"};function ue(i,o,l,u,b,f){return h(),v("section",de,[$(t("input",{ref:"inputNumber",type:"number","onUpdate:modelValue":o[0]||(o[0]=d=>u.value=d),class:"outline-none w-10 flex-grow text-center"},null,512),[[j,u.value]])])}const D=F(re,[["render",ue]]),ce={class:"flex-between-center bg-gray-100 border-b -m-2 mb-0"},pe={class:"px-3 font-semibold"},me=t("i",{class:"far fa-times text-red-500"},null,-1),fe=[me],ge={class:"py-1.5 flex-between-center"},he=t("i",{class:"fa-light fa-ruler-triangle"},null,-1),be={class:"font-semibold text-pink-500"},xe={key:0,class:"flex"},ve=["onClick"],ye=t("i",{class:"fal fa-plus text-xs"},null,-1),_e={class:"flex-grow"},we={key:0,class:"mt-3 text-right"},Ce=t("i",{class:"far fa-trash text-pink-500 mr-2"},null,-1),Ne=E({__name:"ProductName",props:{productName:Object,gridApi:U,editable:{type:Boolean,default:!1}},emits:["close","deleteProduct"],setup(i,{emit:o}){const{productName:l,gridApi:u,editable:b}=i,f=L("getProductById",null),d=q(),c=R({size_name:null,sizes:[]}),_=P(()=>c.sizes.filter(e=>{if(l.products.find(y=>y.size_id==e.id)==null)return!0}));axios.get(`sizenames/${l.size_names_id}`).then(e=>{c.size_name=e.data.name,c.sizes=e.data.sizes});const w=m([{headerName:"ID",field:"id",width:65},{headerName:"O'lchami",field:"size.name",flex:1},{headerName:"Tan narxi",field:"original_price",editable:!0,width:115,cellEditor:D},{headerName:"Sotuv narxi",field:"price",editable:!0,width:115,cellEditor:D},{headerName:"Soni",field:"count",editable:!0,width:120,cellEditor:K},{headerName:"Kiritilgan sana",field:"created_at",editable:!0,width:115,cellRenderer:e=>moment(e.value).fromNow()},{width:50,headerName:"",onCellClicked:e=>C(e.data),cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{width:50,headerName:"",hide:b==!1,onCellClicked:e=>x(e.data),cellRenderer:()=>'<i class="fal fa-trash text-pink-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:f==null,headerName:"",onCellClicked:e=>{f(e.data.id),setTimeout(()=>o("close"),250)},cellRenderer:()=>'<i class="fa-regular fa-bag-shopping text-orange-600"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]}]);function C(e){d.productName=null;const r={...e};r.count=1,setTimeout(()=>{d.productName={name:l.name,products:[r]}})}function x(e){swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(r=>{r.isConfirmed&&axios.delete(`products/${e.id}`).then(()=>{n.api.applyTransaction({remove:[e]}),l.products=l.products.filter(y=>y.id!=e.id),a(l)})})}function N(e){const r=l.products[l.products.length-1],y={product_names_id:l.id,size_id:e.id,original_price:r?r.original_price:0,price:r?r.price:0,count:1};axios.post("products",y).then(({data:g})=>{l.products.push(g),n.api.applyTransaction({add:[g]}),a(l)})}function s(e){const r=e.data;axios.put(`products/${r.id}`,r).then(()=>{a(l)})}function a(e){u.getRowNode(e.id).setData(e)}const n=R({api:null,columnApi:null});function p(e){n.api=e.api,n.columnApi=e.columnApi}return(e,r)=>{const y=G("AgGridVue");return h(),v("section",{onClick:r[3]||(r[3]=g=>e.$emit("close")),class:"full-absolute z-[70] p-8"},[t("main",{onClick:r[2]||(r[2]=W(()=>{},["stop"])),class:"h-full min-w-[630px] w-[900px] bg-white flex flex-col justify-between p-2"},[t("header",ce,[t("div",pe,A(i.productName.name),1),t("button",{onClick:r[0]||(r[0]=g=>e.$emit("close")),class:"px-4 py-2 hover:bg-gray-200"},fe)]),t("div",ge,[t("span",null,[he,I(" - "),t("span",be,A(c.size_name),1)]),i.editable?(h(),v("div",xe,[(h(!0),v(Q,null,H(k(_),g=>(h(),v("button",{onClick:Je=>N(g),class:"bg-gray-200 shadow rounded-sm border-b-2 border-pink-500 w-14 px-2 py-0.5 ml-2 flex-between-center active:bg-gray-200 hover:bg-gray-300"},[ye,I(),t("span",null,A(g.name),1)],8,ve))),256))])):S("",!0)]),t("aside",_e,[T(y,{class:"h-full ag-theme-alpine",getRowId:g=>g.data.id,rowData:i.productName.products,columnDefs:w.value,onCellValueChanged:s,onGridReady:p,animateRows:!0,undoRedoCellEditing:!0},null,8,["getRowId","rowData","columnDefs"])]),i.editable?(h(),v("div",we,[t("button",{onClick:r[1]||(r[1]=g=>e.$emit("deleteProduct",i.productName)),class:"py-1 px-3 bg-gray-200 shadow border-b-2 border-pink-500 active:bg-gray-300"},[Ce,I(" Mahsulotni o'chirish ")])])):S("",!0)])])}}}),$e={class:"flex-grow flex flex-col"},ke={class:"bg-white px-1 py-2 flex items-center justify-between"},Re={class:"flex items-center"},Te=t("label",{for:"searchInput"},null,-1),De=t("i",{class:"fal fa-search text-sm mr-4 relative top-px"},null,-1),Ae={class:"flex items-center"},Ie={class:"mr-10 flex text-gray-500 items-center"},Ve={class:"mx-2"},ze=t("i",{class:"fa-regular fa-list-ul"},null,-1),Se=[ze],Ee={class:"flex-grow"},Oe=E({__name:"ProductNames",props:["editable"],setup(i,{expose:o}){const l=m("contain"),u=m(null);axios.get("productnames").then(({data:a})=>u.value=a);const b=J(),f=q(),d=m(null),c=R({api:null,columnApi:null});o({agGrid:c});function _(a){d.value=null,setTimeout(()=>d.value=a.data)}function w(a){c.api=a.api,c.columnApi=a.columnApi}function C(a){console.log(a),swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(n=>{n.isConfirmed&&axios.put(`productnames/delete/${a.id}`,a).then(()=>{if(a.sells_sum_count){const p=c.api.getRowNode(a.id);a.products=[],p.setData(a)}else c.api.applyTransaction({remove:[a]});d.value=null})})}function x(a){const n=a.data.products.reduce((p,e)=>p+e.count,0);return l.value=="empty"?n==0:l.value=="contain"?n!=0:!0}function N(a){axios.put(`productnames/${a.data.id}`,a.data)}const s=m([{headerName:"Nomi",field:"name",flex:1,editable:!0},{sortable:!0,resizable:!0,headerName:"Soni",field:"products",width:85,cellRenderer:a=>a.value.reduce((n,p)=>n+p.count,0)},{sortable:!0,headerName:"Turi",field:"category.name",width:120},{sortable:!0,headerName:"Kiritilgan vaqt",field:"created_at",width:120,cellRenderer:a=>moment(a.value).fromNow()},{suppressMovable:!0,pinned:"right",headerName:"",width:50,cellClass:["hover:bg-white","cursor-pointer","text-center"],cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',onCellClicked:a=>{f.productName=null,setTimeout(()=>f.productName=a.data)}},{suppressMovable:!0,pinned:"right",headerName:"",width:50,cellClass:["hover:bg-white","cursor-pointer","text-center"],cellRenderer:()=>'<i class="fal fa-folder-open text-blue-500"></i>',onCellClicked:a=>_(a)}]);return(a,n)=>{const p=G("AgGridVue");return h(),v("main",$e,[T(Z,{name:"fade"},{default:X(()=>[d.value?(h(),Y(Ne,{key:0,gridApi:c.api,productName:d.value,editable:i.editable,onClose:n[0]||(n[0]=e=>d.value=null),onDeleteProduct:C},null,8,["gridApi","productName","editable"])):S("",!0)]),_:1}),t("section",ke,[t("main",Re,[Te,De,t("input",{onInput:n[1]||(n[1]=e=>c.api.setQuickFilter(e.target.value)),id:"searchInput",type:"text",class:"py-0.5 bg-inherit w-full outline-none",placeholder:"Izlash"},null,32)]),t("main",Ae,[t("div",Ie,[t("article",null,[t("label",{for:"alls",class:V(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":l.value=="all"}])}," Barchasi ",2),$(t("input",{hidden:"",id:"alls",type:"radio",name:"filte",onChange:n[2]||(n[2]=e=>c.api.onFilterChanged()),"onUpdate:modelValue":n[3]||(n[3]=e=>l.value=e),value:"all"},null,544),[[z,l.value]])]),t("article",Ve,[t("label",{for:"contains",class:V(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":l.value=="contain"}])}," Mavjud ",2),$(t("input",{hidden:"",id:"contains",type:"radio",name:"filte",onChange:n[4]||(n[4]=e=>c.api.onFilterChanged()),"onUpdate:modelValue":n[5]||(n[5]=e=>l.value=e),value:"contain"},null,544),[[z,l.value]])]),t("article",null,[t("label",{for:"emptys",class:V(["flex items-center px-1 border-b border-transparent",{"text-pink-500 !border-pink-300":l.value=="empty"}])}," Qolmagan ",2),$(t("input",{hidden:"",id:"emptys",type:"radio",name:"filte",onChange:n[6]||(n[6]=e=>c.api.onFilterChanged()),"onUpdate:modelValue":n[7]||(n[7]=e=>l.value=e),value:"empty"},null,544),[[z,l.value]])])]),t("button",{onClick:n[8]||(n[8]=e=>k(b).setListType(!k(b).type)),type:"button",class:"text-xl text-blue-600"},Se)])]),t("section",Ee,[T(p,{class:"h-full ag-theme-alpine",getRowId:e=>e.data.id,rowData:u.value,columnDefs:s.value,animateRows:!0,onCellValueChanged:N,onGridReady:w,undoRedoCellEditing:!0,undoRedoCellEditingLimit:20,doesExternalFilterPass:x,isExternalFilterPresent:()=>l.value!="all"},null,8,["getRowId","rowData","columnDefs","isExternalFilterPresent"])])])}}}),qe={class:"flex-grow flex flex-col"},Ge={class:"bg-white px-1 py-2 flex items-center justify-between"},Me={class:"flex items-center"},Pe=t("label",{for:"searchInput"},null,-1),Be=t("i",{class:"fal fa-search text-sm mr-4 relative top-px"},null,-1),Fe=t("i",{class:"fa-light fa-list-tree"},null,-1),je=[Fe],Le={class:"flex-grow"},Ue=E({__name:"Products",props:{editable:{type:Boolean,default:!1}},setup(i,{expose:o}){const{editable:l}=i,u=J(),b=L("getProductById",null),f=q(),d=m();axios.get("products").then(({data:s})=>{d.value=s});const c=m([{suppressMovable:!0,pinned:"left",headerName:"ID",field:"id",width:70},{headerName:"Nomi",field:"product_names.name",flex:1,minWidth:140},{headerName:"O'lchami",field:"size.name",width:80},{headerName:"Tan narxi",field:"original_price",hide:l==!1,editable:l,width:115,cellEditor:D},{headerName:"Narxi",field:"price",editable:l,width:115,cellEditor:D},{headerName:"Soni",field:"count",editable:l,width:130,cellEditor:K},{headerName:"Kiritilgan sana",field:"created_at",editable:l,width:115,cellRenderer:s=>moment(s.value).fromNow()},{suppressMovable:!0,pinned:"right",width:50,headerName:"",onCellClicked:s=>_(s.data),cellRenderer:()=>'<i class="far fa-barcode-read text-blue-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:l==!1,headerName:"",onCellClicked:s=>w(s.data),cellRenderer:()=>'<i class="fal fa-trash text-pink-500"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]},{suppressMovable:!0,pinned:"right",width:50,hide:b==null,headerName:"",onCellClicked:s=>b(s.data.id),cellRenderer:()=>'<i class="fa-regular fa-bag-shopping text-orange-600"></i>',cellClass:["hover:bg-gray-200","text-center","active:bg-gray-300"]}]);function _(s){f.productName=null;const a={...s};a.count=1,setTimeout(()=>{f.productName={name:s.product_names.name,products:[a]}})}function w(s){l!=!1&&swal.fire({title:"Aniq o'chirmoqchimisiz?",text:"Jarayonni orqaga qaytarib bo'lmaydi!",icon:"warning"}).then(a=>{a.isConfirmed&&axios.delete(`products/${s.id}`).then(()=>{x.api.applyTransaction({remove:[s]})})})}function C(s){if(l==!1)return;const a=s.data;axios.put(`products/${a.id}`,a).then(()=>{})}const x=R({api:null,columnApi:null});function N(s){x.api=s.api,x.columnApi=s.columnApi}return o({productAgGrid:x}),(s,a)=>{const n=G("AgGridVue");return h(),v("aside",qe,[t("section",Ge,[t("main",Me,[Pe,Be,t("input",{onInput:a[0]||(a[0]=p=>x.api.setQuickFilter(p.target.value)),id:"searchInput",type:"text",class:"py-0.5 bg-inherit w-full outline-none",placeholder:"Izlash"},null,32)]),t("button",{onClick:a[1]||(a[1]=p=>k(u).setListType(!k(u).type)),type:"button",class:"text-xl text-blue-600"},je)]),t("section",Le,[T(n,{class:"h-full ag-theme-alpine",getRowId:p=>p.data.id,rowData:d.value,columnDefs:c.value,onCellValueChanged:C,onGridReady:N,animateRows:!0,undoRedoCellEditing:!0},null,8,["getRowId","rowData","columnDefs"])])])}}});export{Oe as _,Ue as a,J as u};
